<%= render "../../common/header.erb" %>

module Testbench
  <% @dut.ports.each do |port|  %>
  <%= port.vlg_definition "wire" %>
  <% end %>

  dut dut(
  <% @dut.ports[0...-1].each do |port|  %>
  .<%= "#{port.name}(#{port.name})," %>

  <% end %>
  .<%= "#{@dut.ports.last.name}(#{@dut.ports.last.name})" if @dut.ports.last%>

  );

  <% @agents.each do |agent|  %>
  <%= "#{agent.name} #{agent.name}" %>( 
    <% agent.control_ports.each do |port| %>
      .<%= "#{port.name}(dut.#{port.name})," %>

    <% end %>
    <% agent.data_ports.each do |port| %>
      .<%= "#{port.name}(dut.#{port.name})," %>

    <% end %>
  <% end %>
  <%= ");" %>   
endmodule
